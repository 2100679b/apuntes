<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Plan de Estudios - Ing. Computaci√≥n</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --bg-primary: #667eea;
            --bg-secondary: #764ba2;
            --bg-surface: #ffffff;
            --bg-card: #f8fafc;
            --text-primary: #2d3748;
            --text-secondary: #718096;
            --border: #e2e8f0;
            --accent: #667eea;
            --shadow: rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #4c51bf;
            --bg-secondary: #553c9a;
            --bg-surface: #1a202c;
            --bg-card: #2d3748;
            --text-primary: #f7fafc;
            --text-secondary: #cbd5e0;
            --border: #4a5568;
            --accent: #667eea;
            --shadow: rgba(0,0,0,0.3);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            min-height: 100vh;
            padding: 10px;
            color: var(--text-primary);
            transition: background 0.3s ease;
        }

        #root {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: var(--bg-surface);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 18px;
            line-height: 1.3;
        }

        .theme-toggle {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            transition: transform 0.2s;
        }

        .theme-toggle:active {
            transform: scale(0.9);
        }

        .controls {
            background: var(--bg-surface);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .filters {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-bottom: 12px;
        }

        .filter-btn {
            padding: 8px 12px;
            border: 2px solid var(--border);
            border-radius: 20px;
            background: var(--bg-surface);
            color: var(--text-primary);
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
            flex: 1;
            min-width: 70px;
            text-align: center;
        }

        .filter-btn.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            background: var(--bg-surface);
            color: var(--text-primary);
            transition: border-color 0.2s;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--accent);
        }

        .plan-container {
            background: var(--bg-surface);
            border-radius: 12px;
            padding: 12px;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .semesters {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .semester-header {
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: white;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .semester-header .toggle-icon {
            font-size: 18px;
            font-weight: bold;
        }

        .semester-content {
            display: none;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-top: none;
            border-radius: 0 0 8px 8px;
            padding: 8px;
            margin-top: -8px;
        }

        .semester-content.open {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .subject-card {
            background: var(--bg-surface);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .subject-card:active {
            transform: scale(0.98);
        }

        .subject-card.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        [data-theme="dark"] .subject-card.selected {
            background: #2d3748;
        }

        .subject-card.prerequisite {
            border-color: #48bb78;
            background: #f0fff4;
        }

        [data-theme="dark"] .subject-card.prerequisite {
            background: #2f4f3f;
        }

        .subject-card.dependent {
            border-color: #ed8936;
            background: #fffaf0;
        }

        [data-theme="dark"] .subject-card.dependent {
            background: #4a3520;
        }

        .subject-card.hidden {
            opacity: 0.3;
            pointer-events: none;
        }

        .subject-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .subject-code {
            font-weight: 700;
            font-size: 11px;
            background: var(--bg-card);
            padding: 3px 6px;
            border-radius: 4px;
            color: var(--text-primary);
        }

        .subject-type {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .type-cb { background: #ff0000; }
        .type-ci { background: #00ff00; }
        .type-cs { background: #0000ff; }
        .type-oc { background: #a52a2a; }
        .type-ia { background: #ffa500; }

        .subject-name {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 6px;
            line-height: 1.3;
        }

        .subject-credits {
            display: flex;
            gap: 4px;
            font-size: 10px;
            color: var(--text-secondary);
        }

        .credit-badge {
            background: var(--bg-card);
            padding: 2px 5px;
            border-radius: 3px;
        }

        .info-panel {
            background: var(--bg-surface);
            border-radius: 12px;
            padding: 16px;
            margin-top: 12px;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 16px;
        }

        .info-item {
            background: var(--bg-card);
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid var(--accent);
        }

        .info-label {
            font-size: 10px;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .info-value {
            font-size: 20px;
            font-weight: 700;
            margin-top: 4px;
        }

        .selection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .clear-btn {
            padding: 6px 12px;
            background: #e53e3e;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
        }

        .clear-btn:active {
            opacity: 0.8;
        }

        .dep-section {
            margin-bottom: 12px;
        }

        .dep-title {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .dep-tag {
            display: inline-block;
            background: var(--bg-card);
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 11px;
            margin: 0 4px 4px 0;
            cursor: pointer;
            border: 1px solid var(--border);
        }

        .dep-tag:active {
            opacity: 0.7;
        }

        .legend {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 11px;
            background: var(--bg-card);
            padding: 4px 8px;
            border-radius: 12px;
        }

        .legend-color {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        /* Desktop */
        @media (min-width: 769px) {
            body { padding: 16px; }
            
            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 24px;
            }

            .semesters {
                flex-direction: row;
                overflow-x: auto;
                gap: 16px;
            }

            .semester {
                flex-shrink: 0;
                width: 280px;
            }

            .semester-header {
                cursor: default;
            }

            .semester-header .toggle-icon {
                display: none;
            }

            .semester-content {
                display: block !important;
                animation: none;
            }

            .subject-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px var(--shadow);
            }

            .info-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const subjects = [
            // Semestre I
            { code: "CB0100-L", name: "Lab. F√≠sica I", semester: 1, theory: 0, lab: 1, credits: 2, type: "CB", prereqs: [] },
            { code: "CB0500-L", name: "Lab. Qu√≠mica", semester: 1, theory: 0, lab: 1, credits: 2, type: "CB", prereqs: [] },
            { code: "CB0200-T", name: "√Ålgebra Superior", semester: 1, theory: 4, lab: 0, credits: 8, type: "CB", prereqs: [] },
            { code: "CB0000-T", name: "C√°lculo I", semester: 1, theory: 5, lab: 0, credits: 10, type: "CB", prereqs: [] },
            { code: "CB0100-T", name: "F√≠sica I", semester: 1, theory: 4, lab: 0, credits: 8, type: "CB", prereqs: [] },
            { code: "CS0000-T", name: "Ingl√©s I", semester: 1, theory: 3, lab: 0, credits: 6, type: "CS", prereqs: [] },
            { code: "OC0000-L", name: "Lab. Herramientas Comp.", semester: 1, theory: 0, lab: 2, credits: 4, type: "OC", prereqs: [] },
            { code: "CB0500-T", name: "Qu√≠mica", semester: 1, theory: 3, lab: 0, credits: 6, type: "CB", prereqs: [] },
            { code: "OC0100-T", name: "T√©cnicas de Estudio", semester: 1, theory: 2, lab: 0, credits: 4, type: "OC", prereqs: [] },
            
            // Semestre II
            { code: "CB0001-T", name: "C√°lculo II", semester: 2, theory: 5, lab: 0, credits: 10, type: "CB", prereqs: ["CB0000-T"] },
            { code: "CI0100-T", name: "Electr√≥nica Anal√≥gica I", semester: 2, theory: 3, lab: 0, credits: 6, type: "CI", prereqs: ["CB0200-T"] },
            { code: "CB0101-T", name: "F√≠sica II", semester: 2, theory: 4, lab: 0, credits: 8, type: "CB", prereqs: ["CB0100-T"] },
            { code: "CS0001-T", name: "Ingl√©s II", semester: 2, theory: 3, lab: 0, credits: 6, type: "CS", prereqs: ["CS0000-T"] },
            { code: "CI0100-L", name: "Lab. Electr√≥nica Anal√≥gica I", semester: 2, theory: 0, lab: 2, credits: 4, type: "CI", prereqs: [] },
            { code: "CB0101-L", name: "Lab. F√≠sica II", semester: 2, theory: 0, lab: 1, credits: 2, type: "CB", prereqs: [] },
            { code: "CI0000-L", name: "Lab. Prog. Computadoras", semester: 2, theory: 0, lab: 2, credits: 4, type: "CI", prereqs: [] },
            { code: "IA7000-T", name: "L√≥gica", semester: 2, theory: 3, lab: 0, credits: 6, type: "IA", prereqs: [] },
            { code: "CI0000-T", name: "Prog. de Computadoras", semester: 2, theory: 3, lab: 0, credits: 6, type: "CI", prereqs: ["OC0000-L"] },
            
            // Semestre III
            { code: "CB0002-T", name: "C√°lculo III", semester: 3, theory: 5, lab: 0, credits: 10, type: "CB", prereqs: ["CB0001-T"] },
            { code: "CI0101-T", name: "Electr√≥nica Anal√≥gica II", semester: 3, theory: 3, lab: 0, credits: 6, type: "CI", prereqs: ["CI0100-T"] },
            { code: "CS0002-T", name: "Ingl√©s III", semester: 3, theory: 3, lab: 0, credits: 6, type: "CS", prereqs: ["CS0001-T"] },
            { code: "CI0101-L", name: "Lab. Electr√≥nica Anal√≥gica II", semester: 3, theory: 0, lab: 2, credits: 4, type: "CI", prereqs: [] },
            { code: "CB0102-L", name: "Lab. Teor√≠a Electromag. I", semester: 3, theory: 0, lab: 2, credits: 4, type: "CB", prereqs: [] },
            { code: "CB0501-L", name: "Lab. Termodin√°mica", semester: 3, theory: 0, lab: 1, credits: 2, type: "CB", prereqs: [] },
            { code: "CB0300-T", name: "M√©todos Num√©ricos", semester: 3, theory: 4, lab: 0, credits: 8, type: "CB", prereqs: ["CB0200-T", "CB0000-T"] },
            { code: "CB0501-T", name: "Termodin√°mica", semester: 3, theory: 4, lab: 0, credits: 8, type: "CB", prereqs: ["CB0000-T"] },
            { code: "CB0102-T", name: "Teor√≠a Electromagn√©tica I", semester: 3, theory: 4, lab: 0, credits: 8, type: "CB", prereqs: ["CB0101-T"] },
            
            // Semestre IV
            { code: "CB0003-T", name: "C√°lculo IV", semester: 4, theory: 5, lab: 0, credits: 10, type: "CB", prereqs: ["CB0002-T"] },
            { code: "CI0200-T", name: "Circuitos El√©ctricos I", semester: 4, theory: 4, lab: 0, credits: 8, type: "CI", prereqs: ["CB0200-T"] },
            { code: "CI0300-T", name: "Electr√≥nica Digital I", semester: 4, theory: 4, lab: 0, credits: 8, type: "CI", prereqs: ["CI0100-T"] },
            { code: "CS0003-T", name: "Ingl√©s IV", semester: 4, theory: 3, lab: 0, credits: 6, type: "CS", prereqs: ["CS0002-T"] },
            { code: "CI0300-L", name: "Lab. Electr√≥nica Digital I", semester: 4, theory: 0, lab: 2, credits: 4, type: "CI", prereqs: [] },
            { code: "CI7100-T", name: "Estructuras de Datos", semester: 4, theory: 3, lab: 0, credits: 6, type: "CI", prereqs: ["CI0000-T"] },
            { code: "CI7101-T", name: "Ingenier√≠a de Programaci√≥n", semester: 4, theory: 4, lab: 0, credits: 8, type: "CI", prereqs: ["CI0000-T"] },
            
            // Semestre V
            { code: "CB7000-T", name: "√Ålgebra Lineal", semester: 5, theory: 4, lab: 0, credits: 8, type: "CB", prereqs: ["CB0200-T", "CB0000-T"] },
            { code: "CB0600-T", name: "Probabilidad y Estad√≠stica", semester: 5, theory: 4, lab: 0, credits: 8, type: "CB", prereqs: ["CB0200-T", "CB0001-T"] },
            { code: "CI0400-T", name: "Control Anal√≥gico I", semester: 5, theory: 3, lab: 0, credits: 6, type: "CI", prereqs: ["CB0003-T"] },
            { code: "CI0400-L", name: "Lab. Control Anal√≥gico I", semester: 5, theory: 0, lab: 2, credits: 4, type: "CI", prereqs: [] },
            { code: "IA7300-T", name: "Paradigmas de Programaci√≥n", semester: 5, theory: 3, lab: 0, credits: 6, type: "IA", prereqs: ["CI7101-T"] },
            { code: "IA7300-L", name: "Lab. Paradigmas de Prog.", semester: 5, theory: 0, lab: 3, credits: 6, type: "IA", prereqs: [] },
            { code: "CI7000-T", name: "Matem√°ticas Discretas", semester: 5, theory: 4, lab: 0, credits: 8, type: "CI", prereqs: ["IA7000-T"] },
            { code: "CI7102-T", name: "An√°lisis de Algoritmos", semester: 5, theory: 4, lab: 0, credits: 8, type: "CI", prereqs: ["CI7100-T"] },
            
            // Semestre VI
            { code: "IA3100-T", name: "Comunicaciones I", semester: 6, theory: 4, lab: 0, credits: 8, type: "IA", prereqs: ["CB0003-T", "CB0102-T"] },
            { code: "IA3100-L", name: "Lab. Comunicaciones I", semester: 6, theory: 0, lab: 1, credits: 2, type: "IA", prereqs: [] },
            { code: "CI0401-T", name: "Control Anal√≥gico II", semester: 6, theory: 3, lab: 0, credits: 6, type: "CI", prereqs: ["CI0400-T"] },
            { code: "CI0401-L", name: "Lab. Control Anal√≥gico II", semester: 6, theory: 0, lab: 2, credits: 4, type: "CI", prereqs: [] },
            { code: "IA7200-T", name: "Graficaci√≥n", semester: 6, theory: 3, lab: 0, credits: 6, type: "IA", prereqs: ["CI0000-T"] },
            { code: "IA7200-L", name: "Lab. Graficaci√≥n", semester: 6, theory: 0, lab: 3, credits: 6, type: "IA", prereqs: [] },
            { code: "OC0300-T", name: "Econom√≠a", semester: 6, theory: 3, lab: 0, credits: 6, type: "OC", prereqs: [] },
            { code: "CI7001-T", name: "Lenguajes Formales y Aut√≥matas", semester: 6, theory: 3, lab: 0, credits: 6, type: "CI", prereqs: ["CI7000-T"] },
            { code: "IA7400-T", name: "Organizaci√≥n de Computadoras", semester: 6, theory: 3, lab: 0, credits: 6, type: "IA", prereqs: ["CI0300-T"] },
            
            // Semestre VII
            { code: "IA7500-T", name: "Bases de Datos", semester: 7, theory: 4, lab: 0, credits: 8, type: "IA", prereqs: ["CI7101-T", "IA7000-T"] },
            { code: "IA7500-L", name: "Lab. Bases de Datos", semester: 7, theory: 0, lab: 2, credits: 4, type: "IA", prereqs: [] },
            { code: "IA7100-T", name: "Compiladores", semester: 7, theory: 3, lab: 0, credits: 6, type: "IA", prereqs: ["CI7001-T"] },
            { code: "IA7800-T", name: "Inv. de Operaciones", semester: 7, theory: 3, lab: 0, credits: 6, type: "IA", prereqs: ["CB0001-T", "CB7000-T"] },
            { code: "IA7600-T", name: "Redes de Computadoras", semester: 7, theory: 4, lab: 0, credits: 8, type: "IA", prereqs: ["CI0000-T", "CI0300-T"] },
            { code: "IA7600-L", name: "Lab. Redes de Computadoras", semester: 7, theory: 0, lab: 3, credits: 6, type: "IA", prereqs: [] },
            { code: "CI7002-T", name: "Teor√≠a de la Computaci√≥n", semester: 7, theory: 4, lab: 0, credits: 8, type: "CI", prereqs: ["CI7001-T"] },
            
            // Semestre VIII
            { code: "OC0400-T", name: "Administraci√≥n", semester: 8, theory: 3, lab: 0, credits: 6, type: "OC", prereqs: [] },
            { code: "CS0200-T", name: "√âtica Profesional", semester: 8, theory: 3, lab: 0, credits: 6, type: "CS", prereqs: [] },
            { code: "IA3400-T", name: "Control Digital I", semester: 8, theory: 3, lab: 0, credits: 6, type: "IA", prereqs: ["CI0401-T"] },
            { code: "IA3400-L", name: "Lab. Control Digital I", semester: 8, theory: 0, lab: 1, credits: 2, type: "IA", prereqs: [] },
            { code: "CI7300-T", name: "Modelos Probabilistas", semester: 8, theory: 3, lab: 0, credits: 6, type: "CI", prereqs: ["CB0600-T"] },
            { code: "CI7200-T", name: "Sistemas Operativos", semester: 8, theory: 4, lab: 0, credits: 8, type: "CI", prereqs: ["CI0000-T"] },
            { code: "CI7200-L", name: "Lab. Sistemas Operativos", semester: 8, theory: 0, lab: 5, credits: 10, type: "CI", prereqs: [] },
            
            // Semestre IX
            { code: "OC0200-T", name: "Contabilidad", semester: 9, theory: 3, lab: 0, credits: 6, type: "OC", prereqs: [] },
            { code: "CS0100-T", name: "Expresi√≥n Oral y Escrita", semester: 9, theory: 4, lab: 0, credits: 8, type: "CS", prereqs: [] },
            { code: "IA7700-T", name: "Inteligencia Artificial", semester: 9, theory: 3, lab: 0, credits: 6, type: "IA", prereqs: ["CI7000-T", "IA7300-T"] },
            { code: "IA7700-L", name: "Lab. Inteligencia Artificial", semester: 9, theory: 0, lab: 3, credits: 6, type: "IA", prereqs: [] },
            
            // Semestre X
            { code: "OC0500-T", name: "Seminario de Tesis", semester: 10, theory: 4, lab: 0, credits: 8, type: "OC", prereqs: [] },
        ];

        const typeColors = {
            CB: { name: "B√°sicas", color: "#ff0000" },
            CI: { name: "Ingenier√≠a", color: "#00ff00" },
            CS: { name: "Sociales", color: "#0000ff" },
            OC: { name: "Otras", color: "#a52a2a" },
            IA: { name: "Aplicada", color: "#ffa500" }
        };

        function getAllPrerequisites(code, visited = new Set()) {
            if (visited.has(code)) return [];
            visited.add(code);
            const subject = subjects.find(s => s.code === code);
            if (!subject) return [];
            let allPrereqs = [...subject.prereqs];
            subject.prereqs.forEach(prereq => {
                allPrereqs = [...allPrereqs, ...getAllPrerequisites(prereq, visited)];
            });
            return [...new Set(allPrereqs)];
        }

        function getAllDependents(code, visited = new Set()) {
            if (visited.has(code)) return [];
            visited.add(code);
            const directDeps = subjects.filter(s => s.prereqs.includes(code)).map(s => s.code);
            let allDeps = [...directDeps];
            directDeps.forEach(dep => {
                allDeps = [...allDeps, ...getAllDependents(dep, visited)];
            });
            return [...new Set(allDeps)];
        }

        function App() {
            const [theme, setTheme] = useState(() => localStorage.getItem('theme') || 'light');
            const [selectedSubjects, setSelectedSubjects] = useState([]);
            const [filterType, setFilterType] = useState("all");
            const [searchTerm, setSearchTerm] = useState("");
            const [openSemesters, setOpenSemesters] = useState({});

            useEffect(() => {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
            }, [theme]);

            useEffect(() => {
                const isMobile = window.innerWidth <= 768;
                const initialOpen = {};
                for (let i = 1; i <= 10; i++) {
                    initialOpen[i] = !isMobile;
                }
                if (isMobile) initialOpen[1] = true;
                setOpenSemesters(initialOpen);
            }, []);

            const toggleTheme = () => setTheme(prev => prev === 'light' ? 'dark' : 'light');

            const toggleSemester = (sem) => {
                if (window.innerWidth <= 768) {
                    setOpenSemesters(prev => ({ ...prev, [sem]: !prev[sem] }));
                }
            };

            const filteredSubjects = useMemo(() => {
                return subjects.filter(subject => {
                    const matchesType = filterType === "all" || subject.type === filterType;
                    const matchesSearch = searchTerm === "" || 
                        subject.code.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        subject.name.toLowerCase().includes(searchTerm.toLowerCase());
                    return matchesType && matchesSearch;
                });
            }, [filterType, searchTerm]);

            const handleSubjectClick = (subject) => {
                setSelectedSubjects(prev => {
                    const isSelected = prev.some(s => s.code === subject.code);
                    return isSelected 
                        ? prev.filter(s => s.code !== subject.code)
                        : [...prev, subject];
                });
            };

            const allPrerequisites = useMemo(() => {
                const prereqs = new Set();
                selectedSubjects.forEach(subject => {
                    getAllPrerequisites(subject.code).forEach(p => prereqs.add(p));
                });
                return Array.from(prereqs);
            }, [selectedSubjects]);

            const allDependents = useMemo(() => {
                const deps = new Set();
                selectedSubjects.forEach(subject => {
                    getAllDependents(subject.code).forEach(d => deps.add(d));
                });
                return Array.from(deps);
            }, [selectedSubjects]);

            return (
                <div>
                    <div className="header">
                        <h1>Plan de Estudios<br/>Ing. Computaci√≥n</h1>
                        <div className="theme-toggle" onClick={toggleTheme}>
                            {theme === 'light' ? 'üåô' : '‚òÄÔ∏è'}
                        </div>
                    </div>

                    <div className="controls">
                        <div className="filters">
                            <button 
                                className={`filter-btn ${filterType === "all" ? "active" : ""}`}
                                onClick={() => setFilterType("all")}
                            >
                                Todas
                            </button>
                            {Object.entries(typeColors).map(([type, info]) => (
                                <button 
                                    key={type}
                                    className={`filter-btn ${filterType === type ? "active" : ""}`}
                                    onClick={() => setFilterType(type)}
                                >
                                    {info.name}
                                </button>
                            ))}
                        </div>
                        <input 
                            type="text"
                            className="search-box"
                            placeholder="üîç Buscar materia..."
                            value={searchTerm}
                            onChange={(e) => setSearchTerm(e.target.value)}
                        />
                    </div>

                    <div className="plan-container">
                        <div className="semesters">
                            {Array.from({ length: 10 }, (_, i) => i + 1).map(sem => {
                                const semesterSubjects = filteredSubjects.filter(s => s.semester === sem);
                                const isOpen = openSemesters[sem];

                                return (
                                    <div key={sem} className="semester">
                                        <div 
                                            className={`semester-header ${isOpen ? 'open' : ''}`}
                                            onClick={() => toggleSemester(sem)}
                                        >
                                            <span>Semestre {sem}</span>
                                            <span className="toggle-icon">{isOpen ? '‚àí' : '+'}</span>
                                        </div>
                                        <div className={`semester-content ${isOpen ? 'open' : ''}`}>
                                            {semesterSubjects.length === 0 && (
                                                <div style={{textAlign: 'center', padding: '10px', opacity: 0.5, fontSize: '12px'}}>
                                                    Sin materias
                                                </div>
                                            )}
                                            {semesterSubjects.map(subject => {
                                                const isSelected = selectedSubjects.some(s => s.code === subject.code);
                                                const isPrereq = allPrerequisites.includes(subject.code);
                                                const isDependent = allDependents.includes(subject.code);
                                                const isRelevant = searchTerm === "" || 
                                                    subject.code.toLowerCase().includes(searchTerm.toLowerCase()) || 
                                                    subject.name.toLowerCase().includes(searchTerm.toLowerCase());

                                                return (
                                                    <div 
                                                        key={subject.code}
                                                        className={`subject-card ${isSelected ? "selected" : ""} ${isPrereq ? "prerequisite" : ""} ${isDependent ? "dependent" : ""} ${!isRelevant ? "hidden" : ""}`}
                                                        onClick={() => handleSubjectClick(subject)}
                                                    >
                                                        <div className="subject-top">
                                                            <span className="subject-code">{subject.code}</span>
                                                            <div className={`subject-type type-${subject.type.toLowerCase()}`}></div>
                                                        </div>
                                                        <div className="subject-name">{subject.name}</div>
                                                        <div className="subject-credits">
                                                            <span className="credit-badge">T:{subject.theory}</span>
                                                            <span className="credit-badge">P:{subject.lab}</span>
                                                            <span className="credit-badge">C:{subject.credits}</span>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>

                    <div className="info-panel">
                        <h2 style={{fontSize: "16px", marginBottom: "12px"}}>Informaci√≥n</h2>
                        <div className="info-grid">
                            <div className="info-item">
                                <div className="info-label">Materias</div>
                                <div className="info-value">{subjects.length}</div>
                            </div>
                            <div className="info-item">
                                <div className="info-label">Cr√©ditos</div>
                                <div className="info-value">{subjects.reduce((sum, s) => sum + s.credits, 0)}</div>
                            </div>
                        </div>

                        {selectedSubjects.length > 0 && (
                            <div>
                                <div className="selection-header">
                                    <h3 style={{fontSize: "14px"}}>Selecci√≥n ({selectedSubjects.length})</h3>
                                    <button className="clear-btn" onClick={() => setSelectedSubjects([])}>
                                        Limpiar
                                    </button>
                                </div>
                                
                                {allPrerequisites.length > 0 && (
                                    <div className="dep-section">
                                        <div className="dep-title">üìö Requisitos:</div>
                                        <div>
                                            {allPrerequisites.map(prereq => (
                                                <div 
                                                    key={prereq} 
                                                    className="dep-tag"
                                                    onClick={() => {
                                                        const s = subjects.find(sub => sub.code === prereq);
                                                        if(s) handleSubjectClick(s);
                                                    }}
                                                >
                                                    {prereq}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {allDependents.length > 0 && (
                                    <div className="dep-section">
                                        <div className="dep-title">üéØ Desbloquea:</div>
                                        <div>
                                            {allDependents.map(dep => (
                                                <div 
                                                    key={dep} 
                                                    className="dep-tag"
                                                    onClick={() => {
                                                        const s = subjects.find(sub => sub.code === dep);
                                                        if(s) handleSubjectClick(s);
                                                    }}
                                                >
                                                    {dep}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        <div className="legend">
                            {Object.entries(typeColors).map(([type, info]) => (
                                <div key={type} className="legend-item">
                                    <div className="legend-color" style={{background: info.color}}></div>
                                    <span>{info.name}</span>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>